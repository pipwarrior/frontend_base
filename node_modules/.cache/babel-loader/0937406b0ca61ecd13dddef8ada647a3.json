{"ast":null,"code":"import _regeneratorRuntime from\"/Users/yapfengwei/Desktop/MyApplications/catalogProject_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/yapfengwei/Desktop/MyApplications/catalogProject_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{useContext}from'react';import{Formik,Form,Field}from'formik';import FormText from'../../Components/FormComponents/FormText';import FormSubmitButton from'../../Components/FormComponents/FormSubmitButton';import{makeStyles,Card,CardContent,Typography}from'@material-ui/core';import UserContext from'../../context/UserContext';import{useHistory}from'react-router-dom';import axios from'axios';import Swal from'sweetalert2';var useStyles=makeStyles({root:{minWidth:'300px',width:'60%',margin:'auto',marginTop:'10%'},bullet:{display:'inline-block',margin:'0 2px',transform:'scale(0.8)'},title:{fontSize:14},pos:{marginBottom:12}});var Login=function Login(){var history=useHistory();var _useContext=useContext(UserContext),setUserData=_useContext.setUserData;var classes=useStyles();var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(values){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios({method:'post',url:process.env.REACT_APP_API+'/api/auth/login',data:values}).then(function(loginRes){if(loginRes.data.error){Swal.fire({icon:'error',title:'Error!',text:loginRes.data.error,confirmButtonText:'Ok'});}else{setUserData({token:loginRes.data.token,accountType:loginRes.data.user.accountType,username:loginRes.data.user.username,fullName:loginRes.data.user.fullName});localStorage.setItem('auth-token',loginRes.data.token);localStorage.setItem('accountType',loginRes.data.user.accountType);history.push('/catalog');}}).catch(function(err){var errMessage=err;Swal.fire({icon:'error',title:'Something went wrong..',text:errMessage,confirmButtonText:'Ok'});});case 2:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();var initialValues={username:'',password:''};return/*#__PURE__*/React.createElement(\"div\",{className:classes.root},/*#__PURE__*/React.createElement(Card,{variant:\"outlined\"},/*#__PURE__*/React.createElement(CardContent,null,/*#__PURE__*/React.createElement(Typography,{variant:\"h5\",component:\"h2\",gutterBottom:true},\"My catalog\"),/*#__PURE__*/React.createElement(Typography,{variant:\"body2\",component:\"p\"},\"Login\"),/*#__PURE__*/React.createElement(Formik,{initialValues:initialValues,onSubmit:handleSubmit},function(values){return/*#__PURE__*/ (// handleChange,\nReact.createElement(Form,null,/*#__PURE__*/React.createElement(Field,{title:\"Username\",name:\"username\",type:\"text\",component:FormText}),/*#__PURE__*/React.createElement(Field,{title:\"Password\",name:\"password\",type:\"password\",component:FormText}),/*#__PURE__*/React.createElement(FormSubmitButton,{width:100})));}))));};export default Login;","map":{"version":3,"sources":["/Users/yapfengwei/Desktop/MyApplications/catalogProject_frontend/src/Pages/auth/login.js"],"names":["React","useContext","Formik","Form","Field","FormText","FormSubmitButton","makeStyles","Card","CardContent","Typography","UserContext","useHistory","axios","Swal","useStyles","root","minWidth","width","margin","marginTop","bullet","display","transform","title","fontSize","pos","marginBottom","Login","history","setUserData","classes","handleSubmit","values","method","url","process","env","REACT_APP_API","data","then","loginRes","error","fire","icon","text","confirmButtonText","token","accountType","user","username","fullName","localStorage","setItem","push","catch","err","errMessage","initialValues","password"],"mappings":"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","sourcesContent":["import React, { useContext } from 'react';\nimport { Formik, Form, Field } from 'formik';\nimport FormText from '../../Components/FormComponents/FormText';\nimport FormSubmitButton from '../../Components/FormComponents/FormSubmitButton';\nimport { makeStyles, Card, CardContent, Typography } from '@material-ui/core';\nimport UserContext from '../../context/UserContext';\nimport { useHistory } from 'react-router-dom';\nimport axios from 'axios';\nimport Swal from 'sweetalert2';\n\nconst useStyles = makeStyles({\n  root: {\n    minWidth: '300px',\n    width: '60%',\n    margin: 'auto',\n    marginTop: '10%',\n  },\n  bullet: {\n    display: 'inline-block',\n    margin: '0 2px',\n    transform: 'scale(0.8)',\n  },\n  title: {\n    fontSize: 14,\n  },\n  pos: {\n    marginBottom: 12,\n  },\n});\n\nconst Login = () => {\n  const history = useHistory();\n  const { setUserData } = useContext(UserContext);\n  const classes = useStyles();\n  \n  const handleSubmit = async (values) => {\n    await axios({\n      method:'post',\n      url: process.env.REACT_APP_API+'/api/auth/login',\n      data: values\n    }).then(function(loginRes){\n      if(loginRes.data.error) {\n        Swal.fire({\n          icon: 'error',\n          title: 'Error!',\n          text: loginRes.data.error,\n          confirmButtonText: 'Ok'\n        })\n       } else {\n        setUserData({\n          token: loginRes.data.token,\n          accountType: loginRes.data.user.accountType,\n          username: loginRes.data.user.username,\n          fullName: loginRes.data.user.fullName\n        })\n        localStorage.setItem('auth-token', loginRes.data.token);\n        localStorage.setItem('accountType', loginRes.data.user.accountType);\n        history.push('/catalog');\n       }\n    }).catch(function(err){\n      let errMessage = err;\n      Swal.fire({\n        icon: 'error',\n        title: 'Something went wrong..',\n        text: errMessage,\n        confirmButtonText: 'Ok'\n      })\n    })\n  }\n\n  const initialValues = {\n    username: '',\n    password: ''\n  }\n\n  return (\n    <div className={classes.root}>\n      <Card variant=\"outlined\">\n        <CardContent>\n          <Typography variant=\"h5\" component=\"h2\" gutterBottom>My catalog</Typography>\n          <Typography variant=\"body2\" component=\"p\">Login</Typography>\n          <Formik\n            initialValues={initialValues}\n            onSubmit={handleSubmit}\n          >\n            {(\n              values,\n              // handleChange,\n              ) => (\n                <Form>\n                  <Field\n                    title=\"Username\"\n                    name=\"username\"\n                    type=\"text\"\n                    component={FormText}\n                  />\n                  <Field\n                    title=\"Password\"\n                    name=\"password\"\n                    type=\"password\"\n                    component={FormText}\n                  />\n                  <FormSubmitButton\n                    width={100}\n                  />\n                </Form>\n              )}\n          </Formik>\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n\nexport default Login;"]},"metadata":{},"sourceType":"module"}