{"ast":null,"code":"var _jsxFileName = \"/Users/yapfengwei/Desktop/MyApplications/sample3_frontend/src/App.js\";\nimport React, { useEffect, useState } from 'react';\nimport { BrowserRouter as Router } from 'react-router-dom';\nimport axios from 'axios';\nimport UserContext from './context/UserContext.js';\nimport Routes from './Routes';\nimport Header from './Components/Layout/Header';\nimport './App.css';\n\nconst App = () => {\n  const [userData, setUserData] = useState({\n    token: undefined,\n    user: undefined\n  });\n  useEffect(() => {\n    const checkLoggedIn = async () => {\n      let token = localStorage.getItem('auth-token');\n\n      if (token === null) {\n        localStorage.setItem('auth-token', '');\n        token = '';\n      }\n\n      console.log('=== checkLoggedIn ===');\n      console.log(`token: ${token}`);\n      const tokenRes = await axios.post('http://localhost:3030/api/auth/tokenIsValid', null, {\n        headers: {\n          'auth-token': token\n        }\n      });\n      console.log(`tokenRes.data: ${tokenRes.data}`);\n\n      if (tokenRes.data) {\n        const userRes = await axios.get('http://localhost:3030/api/users', {\n          headers: {\n            'auth-token': token\n          }\n        });\n        setUserData({\n          token,\n          user: userRes.data\n        });\n      }\n    };\n\n    checkLoggedIn();\n  }, []);\n  return /*#__PURE__*/React.createElement(Router, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(UserContext.Provider, {\n    value: {\n      userData,\n      setUserData\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Routes, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 9\n    }\n  })));\n};\n\nexport default App;","map":{"version":3,"sources":["/Users/yapfengwei/Desktop/MyApplications/sample3_frontend/src/App.js"],"names":["React","useEffect","useState","BrowserRouter","Router","axios","UserContext","Routes","Header","App","userData","setUserData","token","undefined","user","checkLoggedIn","localStorage","getItem","setItem","console","log","tokenRes","post","headers","data","userRes","get"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,SAASC,aAAa,IAAIC,MAA1B,QAAwC,kBAAxC;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,WAAP,MAAwB,0BAAxB;AAEA,OAAOC,MAAP,MAAmB,UAAnB;AACA,OAAOC,MAAP,MAAmB,4BAAnB;AAEA,OAAO,WAAP;;AAEA,MAAMC,GAAG,GAAG,MAAM;AAChB,QAAM,CAACC,QAAD,EAAWC,WAAX,IAA0BT,QAAQ,CAAC;AACvCU,IAAAA,KAAK,EAAEC,SADgC;AAEvCC,IAAAA,IAAI,EAAED;AAFiC,GAAD,CAAxC;AAKAZ,EAAAA,SAAS,CAAC,MAAM;AACd,UAAMc,aAAa,GAAG,YAAY;AAChC,UAAIH,KAAK,GAAGI,YAAY,CAACC,OAAb,CAAqB,YAArB,CAAZ;;AACA,UAAGL,KAAK,KAAK,IAAb,EAAmB;AACjBI,QAAAA,YAAY,CAACE,OAAb,CAAqB,YAArB,EAAkC,EAAlC;AACAN,QAAAA,KAAK,GAAC,EAAN;AACD;;AACDO,MAAAA,OAAO,CAACC,GAAR,CAAY,uBAAZ;AACAD,MAAAA,OAAO,CAACC,GAAR,CAAa,UAASR,KAAM,EAA5B;AACA,YAAMS,QAAQ,GAAG,MAAMhB,KAAK,CAACiB,IAAN,CACrB,6CADqB,EAErB,IAFqB,EAGrB;AAACC,QAAAA,OAAO,EAAE;AAAC,wBAAcX;AAAf;AAAV,OAHqB,CAAvB;AAKAO,MAAAA,OAAO,CAACC,GAAR,CAAa,kBAAiBC,QAAQ,CAACG,IAAK,EAA5C;;AACA,UAAGH,QAAQ,CAACG,IAAZ,EAAiB;AACf,cAAMC,OAAO,GAAG,MAAMpB,KAAK,CAACqB,GAAN,CAAU,iCAAV,EAA6C;AAACH,UAAAA,OAAO,EAAE;AAAC,0BAAcX;AAAf;AAAV,SAA7C,CAAtB;AACAD,QAAAA,WAAW,CAAC;AACVC,UAAAA,KADU;AAEVE,UAAAA,IAAI,EAAEW,OAAO,CAACD;AAFJ,SAAD,CAAX;AAID;AACF,KArBD;;AAsBAT,IAAAA,aAAa;AACd,GAxBQ,EAwBN,EAxBM,CAAT;AA0BA,sBACE,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,WAAD,CAAa,QAAb;AAAsB,IAAA,KAAK,EAAE;AAAEL,MAAAA,QAAF;AAAYC,MAAAA;AAAZ,KAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,eAEE,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CADF,CADF;AAQD,CAxCD;;AA0CA,eAAeF,GAAf","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { BrowserRouter as Router } from 'react-router-dom';\nimport axios from 'axios';\nimport UserContext from './context/UserContext.js';\n\nimport Routes from './Routes';\nimport Header from './Components/Layout/Header';\n\nimport './App.css';\n\nconst App = () => {\n  const [userData, setUserData] = useState({\n    token: undefined,\n    user: undefined,\n  })\n\n  useEffect(() => {\n    const checkLoggedIn = async () => {\n      let token = localStorage.getItem('auth-token');\n      if(token === null) {\n        localStorage.setItem('auth-token','');\n        token='';\n      }\n      console.log('=== checkLoggedIn ===');\n      console.log(`token: ${token}`);\n      const tokenRes = await axios.post(\n        'http://localhost:3030/api/auth/tokenIsValid',\n        null,\n        {headers: {'auth-token': token}}\n      )\n      console.log(`tokenRes.data: ${tokenRes.data}`);\n      if(tokenRes.data){\n        const userRes = await axios.get('http://localhost:3030/api/users', {headers: {'auth-token': token}});\n        setUserData({\n          token,\n          user: userRes.data\n        })\n      }\n    }\n    checkLoggedIn();\n  }, [])\n  \n  return (\n    <Router>\n      <UserContext.Provider value={{ userData, setUserData }}>\n        <Header />\n        <Routes />\n      </UserContext.Provider>\n    </Router>\n  )\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}